!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ex=t()}(this,(function(){"use strict";function e(e,t){return e.indexOf(t)>-1}const t=t=>{const n=navigator.userAgent;if("ie"===t){if(e(n,"compatible")&&e(n,"MSIE")){return new RegExp("MSIE (\\d+\\.\\d+)").test(n),parseFloat(RegExp.$1)}return!1}return e(n,t)},n=(e,t,{separator:n,quoted:o})=>{const a=t.map((e=>o?`"${e="string"==typeof e?e.replace(/"/g,'"'):e}"`:e));e.push(a.join(n))},o={separator:",",quoted:!1};const a=(n,o)=>{if(t("ie")&&t("ie")<10){const e=window.top.open("about:blank","_blank");e.document.charset="utf-8",e.document.write(o),e.document.close(),e.document.execCommand("SaveAs",n),e.close()}else if(10===t("ie")||(()=>{let t=0;const n=/MSIE (\d+\.\d+)/.test(navigator.userAgent),o=!!navigator.userAgent.match(/Trident\/7.0/);return n&&(t=Number(RegExp.$1)),e(navigator.appVersion,"MSIE 10")&&(t=10),o&&e(navigator.userAgent,"rv:11.0")&&(t=11),11===t})()||/Edge/.test(navigator.userAgent)){const e=new Blob(["\ufeff"+o],{type:"text/csv"});navigator.msSaveBlob(e,n)}else{const e=document.createElement("a");e.download=n,e.href=(e=>{if(window.Blob&&window.URL&&window.URL.createObjectURL){const t=new Blob(["\ufeff"+e],{type:"text/csv"});return URL.createObjectURL(t)}return"data:attachment/csvcharset=utf-8,\ufeff"+encodeURIComponent(e)})(o),document.body.appendChild(e),e.click(),document.body.removeChild(e)}};return{csv:t=>{t.filename?e(t.filename,".csv")||e(t.filename,".xls")||e(t.filename,".xlsx")||(t.filename+=".csv"):t.filename="table.csv";let r=[],i=[];if(!t.columns||!t.data)return window.alert("请传入表头和数据");r=t.columns,i=t.data;let c=!1;"noHeader"in t&&(c=t.noHeader);const s=function(e,t,a,r=!1){let i;a=Object.assign({},o,a);const c=[],s=[];return e?(i=e.map((e=>"string"==typeof e?e:(r||s.push(void 0!==e.title?e.title:e.key),e.key))),s.length>0&&n(c,s,a)):(i=[],t.forEach((e=>{Array.isArray(e)||(i=i.concat(Object.keys(e)))})),i.length>0&&(i=i.filter(((e,t,n)=>n.indexOf(e)===t)),r||n(c,i,a))),Array.isArray(t)&&t.forEach((e=>{Array.isArray(e)||(e=i.map((t=>void 0!==e[t]?e[t]:""))),n(c,e,a)})),c.join("\r\n")}(r,i,t,c);t.callback?t.callback(s):a(t.filename,s)}}}));
