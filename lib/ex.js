!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).ex=n()}(this,(function(){"use strict";function e(e,n){return e.indexOf(n)>-1}var n=function(n){var t=navigator.userAgent;return"ie"===n?!!(e(t,"compatible")&&e(t,"MSIE"))&&(new RegExp("MSIE (\\d+\\.\\d+)").test(t),parseFloat(RegExp.$1)):e(t,n)},t=function(e,n,t){var a=t.separator,r=t.quoted,o=n.map((function(e){return r?(e="string"==typeof e?e.replace(/"/g,'"'):e,'"'.concat(e,'"')):e}));e.push(o.join(a))},a={separator:",",quoted:!1};var r=function(t,a){if(n("ie")&&n("ie")<10){var r=window.top.open("about:blank","_blank");r.document.charset="utf-8",r.document.write(a),r.document.close(),r.document.execCommand("SaveAs",t),r.close()}else if(10===n("ie")||(c=0,u=/MSIE (\d+\.\d+)/.test(navigator.userAgent),f=!!navigator.userAgent.match(/Trident\/7.0/),u&&(c=Number(RegExp.$1)),e(navigator.appVersion,"MSIE 10")&&(c=10),f&&e(navigator.userAgent,"rv:11.0")&&(c=11),11===c)||/Edge/.test(navigator.userAgent)){var o=new Blob(["\ufeff"+a],{type:"text/csv"});navigator.msSaveBlob(o,t)}else{var i=document.createElement("a");i.download=t,i.href=function(e){if(window.Blob&&window.URL&&window.URL.createObjectURL){var n=new Blob(["\ufeff"+e],{type:"text/csv"});return URL.createObjectURL(n)}return"data:attachment/csvcharset=utf-8,\ufeff"+encodeURIComponent(e)}(a),document.body.appendChild(i),i.click(),document.body.removeChild(i)}var c,u,f},o={csv:function(n){n.filename?e(n.filename,".csv")||e(n.filename,".xls")||e(n.filename,".xlsx")||(n.filename+=".csv"):n.filename="table.csv";var o=[],i=[];if(!n.columns||!n.data)return window.alert("请传入表头和数据");o=n.columns,i=n.data;var c=!1;"noHeader"in n&&(c=n.noHeader);var u=function(e,n,r){var o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=Object.assign({},a,r);var c=[],u=[];return e?(o=e.map((function(e){return"string"==typeof e?e:(i||u.push(void 0!==e.title?e.title:e.key),e.key)})),u.length>0&&t(c,u,r)):(o=[],n.forEach((function(e){Array.isArray(e)||(o=o.concat(Object.keys(e)))})),o.length>0&&(o=o.filter((function(e,n,t){return t.indexOf(e)===n})),i||t(c,o,r))),Array.isArray(n)&&n.forEach((function(e){Array.isArray(e)||(e=o.map((function(n){return void 0!==e[n]?e[n]:""}))),t(c,e,r)})),c.join("\r\n")}(o,i,n,c);n.callback?n.callback(u):r(n.filename,u)}};return o}));
